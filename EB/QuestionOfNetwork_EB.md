# Question of Network for CS interview

> 목차
> * 웹 동작 방식
> * TCP vs. UDP
> * 공인 IP와 사설 IP 차이
> * HTTP 프롵토콜
> * HTTP vs. HTTPS
> * 3 way handshake
> * HTTP1 vs. HTTP2

## 웹 동작 방식

<여기에 그림을 넣을 예정>

1. 사용자가 웹 브라우저에 URL을 입력한다.
2. 브라우저는 DNS를 통해 서버의 진짜 주소를 찾는다.
3. HTTP 프로토콜을 사용하여 HTTP 요청 메세지를 생성한다.
4. TCP/IP 연결을 통해 HTTP 요청이 서버로 전송된다.
5. 서버는 HTTP 프로토콜을 활용해 HTTP 응답 메세지를 생성한다.
6. TCP/IP 연결을 통해 요청한 컴퓨터로 전송한다.
7. 도착한 HTTP 응답 메세지는 웹 페이지 데이터로 변환되고, 웹 브라우저에 의해 출력되어 사용자가 볼 수 있게 된다.

### DNS ( Domain Name Server )

* 도메인 이란?

도메인은 웹 브라우저를 통해 특정 사이트에 진입을 할 때, IP 주소를 대신하여 사용하는 주소이다.

도메인을 이용해서 한눈에 파악하기 힘든 IP주소를 보다 분명하게 나타낼 수 있다.

만약 IP 주소가 지번 또는 도로명 주소라면, 도메인 이름은 해당 주소에 대한 상호로 볼 수 있다. 

😉 터미널에서 도메인의 IP 주소를 확인하는 방법

```` bash
nslookup
````

터미널에서 위의 명령어를 입력하면 된다.

* DNS란?

네트워크 상에 존재하는 모든 PC는 IP 주소를 갖는다.

그러나 모든 IP 주소가 도메인 이름을 갖는 것은 아니다.

local PC를 나타내는 `127.0.0.1`은 `localhost`로 사용할 수 있지만, 그 외의 모든 도메인 이름은 일정 기간 동안 대여하여 사용한다. 

> 그래서 우리가 도메인을 사야 한다는 표현을 쓴다.

* 도메인 이름과 IP 주소 매칭하는 방법

브라우저의 검색창에 도메인 이름을 입력하여 해당 사이트로 이동하기 위해서는, 해당 도메인 이름과 매칭된 IP 주소를 확인하는 작업이 반드시 필요하다.

네트워크에는 이것을 위한 서버가 별도로 있다. 이게 바로 DNS이다.

* DNS가 하는 일

DNS는 데이터베이스 시스템이다.

호스트의 도메인 이름을 IP 주소로 변환하거나 반대의 경우를 수행할 수 있도록 개발된 데이터베이스 시스템이다.

DNS는 범국제적 단위로 웹사이트의 IP 주소와 도메인 주소를 이어주는 환경/시스템이다.

DNS 시스템 안에서 이어주는 역할을 하는 서버를 DNS 서버라고 한다. 

> DNS와 DNS 서버는 분명하게 다르다.

* DNS 처리 순서

1. 브라우저에서 naver.com 을 입력한다.
2. 이 요청은 DNS에서 Ip 주소 (125.209.222.142)를 찾는다.
3. 이 IP 주소에 해당하는 웹 서버로 요청을 전달하여 클라이언트와 서버가 통신할 수 있도록 한다.

[DNS에 대해 쉽게 설명한 블로그](https://hanamon.kr/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B8%B0%EB%B3%B8-%EB%8F%84%EB%A9%94%EC%9D%B8%EA%B3%BC-dns-%EB%84%A4%EC%9E%84%EC%84%9C%EB%B2%84%EB%9E%80-%EA%B0%9C%EB%85%90%ED%8E%B8/)


## TCP vs. UDP

* TCP

연결형 서비스로 3 way handshake 과정을 통해 연결을 설정한다. 그렇기 때문에 높은 신뢰성을 보장하짐나 속도가 비교적 느리다는 단점이 있다. 

주로 신뢰성이 중요한 파일 교환 같은 경우에 쓰인다.

가상 회선 방식으로 패킷을 교환한다.

패킷의 전송 순서를 보장한다.

1:1 통신 방식이다.

* UDP

비연결형 서비스로 3 way handshake 과정을 거치지 않기 때문에 신뢰성이 떨어진다는 단점이 있다. 하지만 수신 여부를 확인하지 않기 때문에 속도가 비교적 빠르다. 

주로 실시간성이 중요한 스트리밍 경우에 쓰인다.

데이터그램 방식으로 패킷을 교환한다.

전송 순서가 바뀔 수 있다.

1:1 / 1:N / N:M 통신 방식이다.

## 공인 IP vs. 사설 IP

* 공인 IP

전 세계에서 유일한 IP로 ISP ( 인터넷 서비스 공급자 )가 제공하는 IP 주소이다.

외부에 공개되어 있기 때문에 인터넷에 연결된 다른 장비로부터 접근이 가능하다.

그에 따라 방화벽 등과 같은 보안 설정을 해주어야 한다.

* 사설 IP

어떤 네트워크 안에서 사용되는 IP 주소이다.

IPv4의 부족으로 인해 모든 네트워크가 공인 IP를 사용하는 것이 불가능하기 때문에 네트워크 안에서 라우터를 통해 할당받는 가상의 주소이다.

별도의 설정 없이는 외부에서 접근이 불가능하다.

## HTTP 프로토콜이란?

HTTP는 서버-클라이언트 모델을 따라 데이터를 주고 받기 위한 프로토콜이다. 어플리케이션 레벨의 프로트콜로 TCP/IP 위에서 동작한다.

HTTP는 상태를 갖지 않는 Stateless 프로토콜이며, Method, Path, Version, Headers, Body 등으로 구성된다.

```` bash
GET / HTTP / 1.1
HOST : developer.mozilla.org
Accept-Language: fr
````

## HTTP vs. HTTPS

HTTP는 평문 데이터를 전송하는 프로토콜이기 때문에, HTTP로 비밀번호나 주민번호 등을 주고 받으면 제 3자에 의해 조회될 수 있다. 이러한 문제를 해결하기 위해 HTTP에 암호화가 추가된 프로토콜이 HTTPS이다. 

HTTPS는 대칭키 암호화와 비대칭키 암호화가 모두 사용된다.

비대칭키 암/복호화는 비용이 매우 크기 때문에, 서버와 클라이언트가 주고 받는 모든 메세지를 비대칭키 암호화하면 오버헤드가 발생할 수 있다. 그래서 서버와 클라이언트가 최초 1회 서로 대칭키를 공유하기 위한 과정에서 비대칭키 암호화를 사용하고 이후에는 대칭키 암호화를 사용한다. 

1. 클라이언트가 서버로 최초 연결을 시도한다.
2. 서버는 공개키를 브라우저에게 넘겨준다.
3. 브라우저는 인증서의 유효성을 검사하고 세션키를 발급한다.
4. 브라우전느 세션키를 보관하며 추가로 서버의 공개키로 세션키를 암호화하여 서버로 전송한다.
5. 서버는 개인키로 암호화된 세션키를 복호화하여 세션키를 얻는다.
6. 클라이언트와 서버는 동일한 세션키를 공유하므로 데이터를 전달할 때, 세션키로 암/복호화를 진행한다. 

## 3 way handshake

TCP 네트워크에서 통신을 하는 장치가 서로 연결이 잘되었는지 확인하는 방법이다. 총 3번에 걸쳐 데이터를 주고 받아서 3 way handshake이다.

1. 서버가 포트를 열어둔다.
2. 클라이언트가 SYN 시그널을 서버로 보낸다.
3. 서버는 SYN + ACK 시그널을 클라이언트로 보낸다.
4. 클라이언트는 ACK 시그널을 서버로 보낸다.

이제 데이터를 요청하고 응답한다.

## HTTP1 vs. HTTP2

HTTP1은 기본적으로 1개의 connection 당 1개의 request/response를 처리한다. 그에 따른 다음과 같은 문제가 있다.

1. HOL ( Head of Line ) Blocking 
> 특정 응답 지연
클라이언트의 요청과 서버의 응답이 동기화되어 지연 발생

2. RTT ( Round Trip Time ) 증가 
> 양방향 지연
패킷 왕복 시간의 지연 발생

3. 헤더 크기의 비대

쿠키 등과 같은 Meta-data에 의해 헤더가 비대해진다.
> 비대해지다 = 크기가 커지다

HTTP2는 다음과 같은 기술을 사용하여 HTTP1의 성능 문제를 해결하였다.

1. Mulitplexed Streams

하나의 Connection으로 여러 개의 request/response를 동시에 주고 받을 수 있다.

2. Stream Prioritization 

요청 온 리소스 간의 의존관계를 설정하여 먼저 응답해야하는 리소스를 우선적으로 반환한다.

3. Header Compression

헤더 정보를 HPACK 압축 방식을 이용하여 압축 전송한다.

4. Server Push

HTML 문서 상에 필요한 리소스를 클라이언트 요청 없이 보내줄 수 있다.

[망나니개발자의 면접대비](https://mangkyu.tistory.com/91)